!function(){var t={};function e(t,e){for(var r=0;r<e.length;r++){var s=e[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,s=Array(e);r<e;r++)s[r]=t[r];return s}function s(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return r(t,e);var s=Object.prototype.toString.call(t).slice(8,-1);if("Object"===s&&t.constructor&&(s=t.constructor.name),"Map"===s||"Set"===s)return Array.from(s);if("Arguments"===s||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(s))return r(t,e)}}(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}t=function(){var t,r;function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.initializeBoard();!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),this.inicialState=t,this.state=this.inicialState.map(function(t){return s(t)}),this.futureState=[],this.score=0,this.status="idle",this.startGame=!1}return t=[{key:"initializeBoard",value:function(){for(var t=[],e=0;e<4;e++)t.push([,,,,].fill(0));return t}},{key:"isEqual",value:function(t,e){for(var r=0;r<t.length;r++)for(var s=0;s<t[r].length;s++)if(t[r][s]!==e[r][s])return!1;return!0}},{key:"moveLeft",value:function(){if(this.startGame){for(var t=0;t<4;t++){var e=s(this.state[t]);e=this.slide(e),this.futureState[t]=e}!this.isEqual(this.futureState,this.state)&&(this.state=this.futureState.map(function(t){return s(t)}),this.setTwo(),this.isWin(this.state),this.isLose()&&(this.status="lose"))}}},{key:"moveRight",value:function(){if(this.startGame){for(var t=0;t<4;t++){var e=s(this.state[t]);e.reverse(),(e=this.slide(e)).reverse(),this.futureState[t]=e}!this.isEqual(this.futureState,this.state)&&(this.state=this.futureState.map(function(t){return s(t)}),this.setTwo(),this.isWin(this.state),this.isLose()&&(this.status="lose"))}}},{key:"moveUp",value:function(){if(this.startGame){this.futureState=this.state.map(function(t){return s(t)});for(var t=0;t<4;t++){var e=[this.futureState[0][t],this.futureState[1][t],this.futureState[2][t],this.futureState[3][t]];e=this.slide(e);for(var r=0;r<4;r++)this.futureState[r][t]=e[r]}!this.isEqual(this.futureState,this.state)&&(this.state=this.futureState.map(function(t){return s(t)}),this.setTwo(),this.isWin(this.state),this.isLose()&&(this.status="lose"))}}},{key:"moveDown",value:function(){if(this.startGame){this.futureState=this.state.map(function(t){return s(t)});for(var t=0;t<4;t++){var e=[this.futureState[0][t],this.futureState[1][t],this.futureState[2][t],this.futureState[3][t]];e.reverse(),(e=this.slide(e)).reverse();for(var r=0;r<4;r++)this.futureState[r][t]=e[r]}!this.isEqual(this.futureState,this.state)&&(this.state=this.futureState.map(function(t){return s(t)}),this.setTwo(),this.isWin(this.state),this.isLose()&&(this.status="lose"))}}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.state.map(function(t){return s(t)})}},{key:"getStatus",value:function(){return this.status}},{key:"setBestScore",value:function(t,e){(null===e||e<t)&&localStorage.setItem("user",t)}},{key:"getBestScore",value:function(){var t=localStorage.getItem("user");return null===t?0:t}},{key:"start",value:function(){this.status="playing",this.startGame=!0,this.state=this.inicialState.map(function(t){return s(t)}),this.score=0,this.setTwo(),this.setTwo()}},{key:"restart",value:function(){this.status="idle",this.startGame=!1,this.state=this.inicialState.map(function(t){return s(t)}),this.score=0}},{key:"slide",value:function(t){for(var e=this.filterZero(t),r=0;r<e.length;r++)e[r]===e[r+1]&&(e[r]*=2,e[r+1]=0,this.score+=e[r]);for(e=this.filterZero(e);e.length<4;)e.push(0);return e}},{key:"filterZero",value:function(t){return t.filter(function(t){return 0!==t})}},{key:"updateTile",value:function(t,e){t.innerText="",t.classList.value="",t.classList.add("field__cell"),e>0&&(t.innerText=e,t.classList.add("field__cell--"+e.toString()))}},{key:"updateScore",value:function(t){t.innerText=this.score}},{key:"setTwo",value:function(){if(this.hasEmptyTile())for(var t=!1;!t;){var e=Math.floor(4*Math.random()),r=Math.floor(4*Math.random());if(0===this.state[e][r]){var s=.9>Math.random()?2:4;this.state[e][r]=s,t=!0}}}},{key:"hasEmptyTile",value:function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++)if(0===this.state[t][e])return!0;return!1}},{key:"isWin",value:function(t){var e=this;t.forEach(function(t){t.forEach(function(t){2048===t&&(e.status="win")})})}},{key:"isLose",value:function(){var t=!0,e=!1,r=void 0;try{for(var s,a=this.state[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var i=function(){var t=s.value;if(t.some(function(t){return 0===t}))return{v:!1};for(var e=0;e<t.length;e++)if(t[e]===t[e+1])return{v:!1}}();if("object"==(i&&"undefined"!=typeof Symbol&&i.constructor===Symbol?"symbol":typeof i))return i.v}}catch(t){e=!0,r=t}finally{try{t||null==a.return||a.return()}finally{if(e)throw r}}for(var n=0;n<4;n++)for(var o=[this.state[0][n],this.state[1][n],this.state[2][n],this.state[3][n]],u=0;u<o.length;u++)if(o[u]===o[u+1])return!1;return!0}}],e(a.prototype,t),r&&e(a,r),a}();var a={score:document.querySelector('[data-score="score"]'),best:document.querySelector('[data-best="best"]'),rows:document.querySelectorAll(".field__cell"),start:document.querySelector(".button"),field:document.querySelector(".game__field"),messageWin:document.querySelector(".message__content--win"),messageLose:document.querySelector(".message__content--lose"),messageStart:document.querySelector(".message__content--start")},i=0,n=new t;function o(){for(var t=0;t<4;t++)for(var e=0;e<4;e++){var r=document.getElementById("".concat(t,"-").concat(e)),s=n.getState()[t][e];n.updateTile(r,s),a.best.innerText=n.getBestScore()}}a.score&&(a.score.innerText=n.getScore()),a.best&&(a.best.innerText=n.getBestScore()),o(),a.start.addEventListener("click",function(){"Start"===a.start.textContent&&(n.start(),o(),n.updateScore(a.score),a.messageStart.classList.add("hidden")),"Restart"===a.start.textContent&&("win"===n.getStatus()&&a.messageWin.classList.add("hidden"),"lose"===n.getStatus()&&a.messageLose.classList.add("hidden"),n.restart(),a.start.innerText="Start",a.start.classList.add("start"),a.start.classList.remove("restart"),i=0,o(),n.updateScore(a.score),a.messageStart.classList.remove("hidden"))}),document.addEventListener("keydown",function(t){("ArrowUp"===t.key||"ArrowDown"===t.key)&&t.preventDefault()}),document.addEventListener("keyup",function(t){switch(n.getStatus()){case"playing":switch(t.code){case"ArrowLeft":n.moveLeft();break;case"ArrowRight":n.moveRight();break;case"ArrowUp":n.moveUp();break;case"ArrowDown":n.moveDown()}o(),i++;break;case"win":a.messageWin.classList.remove("hidden");break;case"lose":a.messageLose.classList.remove("hidden")}n.updateScore(a.score);var e=window.localStorage.getItem("user");n.setBestScore(n.getScore(),e),i>=1&&(a.start.innerText="Restart",a.start.classList.remove("start"),a.start.classList.add("restart"))})}();
//# sourceMappingURL=index.748b10d7.js.map
